<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>公式与函数 - Excel学习中心</title>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <header class="site-header">
        <div class="container">
            <div class="logo">
                <h1>Excel 学习中心</h1>
            </div>
            <nav class="main-nav">
                <ul>
                    <li><a href="excel-structure.html">文件结构</a></li>
                    <li><a href="introduction.html">快速入门</a></li>
                    <li><a href="basics.html">基础操作</a></li>
                    <li><a href="formatting.html">格式化美化</a></li>
                    <li><a href="formulas.html" class="active">公式函数</a></li>
                    <li><a href="charts.html">图表制作</a></li>
                    <li><a href="pivottables.html">数据透视表</a></li>
                    <li><a href="programming.html">编程处理</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="tutorial-page">
<div class="tutorial-header">
            <h1>第四章：公式函数</h1>
        </div>

        <div class="tutorial-content">
            <h2>4.1 公式基础</h2>
            <p>公式是Excel的核心功能，让我们能够进行各种计算和数据分析。</p>

            <h3>公式的基本结构</h3>
            <p>Excel公式总是以等号（=）开头，包含以下元素：</p>
            <ul>
                <li><strong>运算符</strong>：+、-、*、/、^ 等</li>
                <li><strong>单元格引用</strong>：A1、B2、C1:C10 等</li>
                <li><strong>数值</strong>：123、45.67 等</li>
                <li><strong>函数</strong>：SUM、AVERAGE、IF 等</li>
                <li><strong>常量</strong>：文本用双引号括起来，如"总计"</li>
            </ul>

            <h3>输入公式</h3>
            <ol>
                <li>选中要输入公式的单元格</li>
                <li>输入等号（=）开始公式</li>
                <li>输入公式内容</li>
                <li>按Enter完成输入</li>
            </ol>

            <h3>基本运算符</h3>
            <div class="code-block">
                +（加法）：=A1+B1<br/>
                -（减法）：=A1-B1<br/>
                *（乘法）：=A1*10%<br/>
                /（除法）：=A1/B1<br/>
                ^（乘方）：=A1^2<br/>
                %（百分比）：=50%<br/>
                &（连接）：="总计："&A1
            </div>

            <h3>运算符优先级</h3>
            <p>Excel按照以下顺序执行运算：</p>
            <ol>
                <li>括号（()</li>
                <li>引用运算符（: , 空格）</li>
                <li>负数（-）</li>
                <li>百分比（%）</li>
                <li>乘方（^）</li>
                <li>乘除（* /）</li>
                <li>加减（+ -）</li>
                <li>连接（&）</li>
                <li>比较（= < > <= >= <>）</li>
            </ol>

            <div class="warning-box">
                <strong>注意：</strong>运算符优先级相同的情况下，从左到右计算。使用括号可以改变运算顺序。
            </div>

            <h2>4.2 单元格引用</h2>
            <p>理解不同类型的单元格引用对编写正确公式至关重要。</p>

            <h3>相对引用</h3>
            <p>默认的引用方式，复制公式时会自动调整引用位置。</p>
            <div class="code-block">
                在C1中输入：=A1+B1<br/>
                复制到C2，会变为：=A2+B2
            </div>

            <h3>绝对引用</h3>
            <p>使用$符号固定行或列，复制时不会改变。</p>
            <div class="code-block">
                在C1中输入：=$A$1+B1<br/>
                复制到C2，会变为：=$A$1+B2
            </div>

            <h3>混合引用</h3>
            <p>部分使用绝对引用，部分使用相对引用。</p>
            <div class="code-block">
                $A1：固定列A，行相对变化<br/>
                A$1：固定行1，列相对变化
            </div>

            <h3>引用快捷键</h3>
            <p>选中引用后按F4键，可以在不同引用类型间切换：</p>
            <ul>
                <li>A1 → $A$1（完全绝对引用）</li>
                <li>$A$1 → A$1（混合引用，固定行）</li>
                <li>A$1 → $A1（混合引用，固定列）</li>
                <li>$A1 → A1（相对引用）</li>
            </ul>

            <div class="tip-box">
                <strong>小技巧：</strong>在编辑公式时，点击引用区域可以自动选择该区域。
            </div>

            <h2>4.3 常用函数</h2>
            <p>Excel提供了数百个内置函数，以下是日常工作最常用的函数。</p>

            <h3>数学函数</h3>
            <div class="code-block">
                SUM(range)：求和<br/>
                AVERAGE(range)：平均值<br/>
                MAX(range)：最大值<br/>
                MIN(range)：最小值<br/>
                COUNT(range)：计数数字<br/>
                COUNTA(range)：计数非空单元格<br/>
                ROUND(number, digits)：四舍五入<br/>
                INT(number)：向下取整<br/>
                MOD(number, divisor)：求余数
            </div>

            <h3>文本函数</h3>
            <div class="code-block">
                LEFT(text, [num_chars])：从左提取字符<br/>
                RIGHT(text, [num_chars])：从右提取字符<br/>
                MID(text, start_num, num_chars)：从中间提取字符<br/>
                LEN(text)：计算文本长度<br/>
                CONCAT(text1, text2, ...)：连接文本<br/>
                TRIM(text)：删除多余空格<br/>
                UPPER(text)：转换为大写<br/>
                LOWER(text)：转换为小写<br/>
                PROPER(text)：首字母大写
            </div>

            <h3>日期函数</h3>
            <div class="code-block">
                TODAY()：当前日期<br/>
                NOW()：当前日期和时间<br/>
                DATE(year, month, day)：创建日期<br/>
                DATEDIF(start_date, end_date, unit)：计算日期差<br/>
                EOMONTH(start_date, months)：月末日期<br/>
                WORKDAY(start_date, days)：工作日
            </div>

            <h3>查找函数</h3>
            <div class="code-block">
                VLOOKUP(lookup_value, table_array, col_index, [range_lookup])：垂直查找<br/>
                HLOOKUP(lookup_value, table_array, row_index, [range_lookup])：水平查找<br/>
                INDEX(array, row_num, [col_num])：返回指定位置的值<br/>
                MATCH(lookup_value, lookup_array, [match_type])：查找位置
            </div>

            <h2>4.4 逻辑函数</h2>
            <p>逻辑函数用于进行条件判断，是数据分析的重要工具。</p>

            <h3>IF函数</h3>
            <p>根据条件返回不同值：</p>
            <div class="code-block">
                =IF(A1>60, "及格", "不及格")<br/>
                =IF(AND(A1>60, B1>60), "双及格", "不及格")<br/>
                =IF(OR(A1>60, B1>60), "单科及格", "都不及格")
            </div>

            <h3>AND函数</h3>
            <p>所有条件都为TRUE时返回TRUE：</p>
            <div class="code-block">
                =AND(A1>60, B1>60)<br/>
                =AND(A1>0, A1<100)
            </div>

            <h3>OR函数</h3>
            <p>任一条件为TRUE时返回TRUE：</p>
            <div class="code-block">
                =OR(A1>60, B1>60)<br/>
                =OR(A1="优秀", A1="良好")
            </div>

            <h3>NOT函数</h3>
            <p>取反逻辑：</p>
            <div class="code-block">
                =NOT(A1=0)<br/>
                =NOT(OR(A1>60, B1>60))
            </div>

            <h3>嵌套IF</h3>
            <p>IF函数可以嵌套使用进行多重判断：</p>
            <div class="code-block">
                =IF(A1>=90, "优秀", IF(A1>=80, "良好", IF(A1>=60, "及格", "不及格")))
            </div>

            <div class="note-box">
                <strong>注意：</strong>Excel支持最多64层IF嵌套，但建议使用其他函数简化复杂逻辑。
            </div>

            <h2>4.5 IF函数替代方案</h2>
            <p>Excel引入了更简洁的IF函数替代方案，让逻辑判断更易读。</p>

            <h3>IFS函数</h3>
            <p>替代多层IF嵌套：</p>
            <div class="code-block">
                =IFS(A1>=90, "优秀", A1>=80, "良好", A1>=60, "及格", TRUE, "不及格")
            </div>

            <h3>SWITCH函数</h3>
            <p>根据值返回不同结果：</p>
            <div class="code-block">
                =SWITCH(A1, "A", "优秀", "B", "良好", "C", "及格", "不及格")
            </div>

            <h2>4.6 统计函数</h2>
            <p>统计函数用于数据分析和计算。</p>

            <div class="code-block">
                COUNT(range)：计数数字<br/>
                COUNTA(range)：计数非空单元格<br/>
                COUNTBLANK(range)：计数空单元格<br/>
                COUNTIF(range, criteria)：条件计数<br/>
                COUNTIFS(range1, criteria1, [range2, criteria2], ...)：多条件计数<br/>
                SUMIF(range, criteria, [sum_range])：条件求和<br/>
                SUMIFS(sum_range, range1, criteria1, [range2, criteria2], ...)：多条件求和<br/>
                AVERAGEIF(range, criteria, [average_range])：条件平均<br/>
                AVERAGEIFS(average_range, range1, criteria1, [range2, criteria2], ...)：多条件平均
            </div>

            <h3>SUMIFS示例</h3>
            <div class="code-block">
                =SUMIFS(C:C, A:A, "销售部", B:B, ">1000")<br/>
                计算A列为"销售部"且B列大于1000的C列总和
            </div>

            <h2>4.7 文本连接函数</h2>
            <p>Excel 2026提供了多种文本连接方法。</p>

            <h3>CONCAT函数</h3>
            <p>连接多个文本字符串：</p>
            <div class="code-block">
                =CONCAT(A1, " ", B1)<br/>
                =CONCAT("姓名：", A1, " 部门：", B1)
            </div>

            <h3>TEXTJOIN函数</h3>
            <p>用分隔符连接多个文本：</p>
            <div class="code-block">
                =TEXTJOIN("、", TRUE, A1:A5)<br/>
                用顿号连接A1到A5的文本，忽略空值
            </div>

            <h2>4.8 数组公式</h2>
            <p>Excel的数组公式功能得到显著增强。</p>

            <h3>动态数组函数</h3>
            <p>Excel支持多种动态数组函数：</p>

            <div class="code-block">
                UNIQUE(array)：返回唯一值<br/>
                SORT(array, [sort_index], [sort_order])：排序<br/>
                FILTER(array, include, [if_empty])：筛选<br/>
                SORTBY(array, by_array1, [sort_order1], ...)：按多列排序<br/>
                RANDARRAY([rows], [columns], [min], [max], [integer])：生成随机数<br/>
                SEQUENCE(rows, [columns], [start], [step])：生成序列<br/>
                XLOOKUP(lookup_value, lookup_array, return_array, [if_not_found], [match_mode], [search_mode])：增强查找<br/>
                XMATCH(lookup_value, lookup_array, [match_mode], [search_mode])：增强匹配
            </div>

            <h3>UNIQUE函数示例</h3>
            <div class="code-block">
                =UNIQUE(A1:A10)<br/>
                返回A1到A10中的唯一值列表
            </div>

            <h3>FILTER函数示例</h3>
            <div class="code-block">
                =FILTER(A1:B10, B1:B10>60)<br/>
                返回B列大于60的所有行，包含A列和B列
            </div>

            <h2>4.9 错误处理</h2>
            <p>了解和处理常见的公式错误很重要。</p>

            <h3>常见错误类型</h3>
            <ul>
                <li><strong>#VALUE!</strong>：参数类型错误</li>
                <li><strong>#DIV/0!</strong>：除以零</li>
                <li><strong>#REF!</strong>：引用无效</li>
                <li><strong>#NAME?</strong>：名称未定义</li>
                <li><strong>#N/A</strong>：值不可用</li>
                <li><strong>#NUM!</strong>：数值错误</li>
                <li><strong>#NULL!</strong>：空交集</li>
            </ul>

            <h3>错误处理函数</h3>
            <div class="code-block">
                IFERROR(value, value_if_error)：处理所有错误<br/>
                IFNA(value, value_if_na)：只处理#N/A错误<br/>
                ERROR.TYPE(error_val)：返回错误类型编号<br/>
                ISERROR(value)：检查是否为错误<br/>
                ISNA(value)：检查是否为#N/A
            </div>

            <h3>IFERROR示例</h3>
            <div class="code-block">
                =IFERROR(VLOOKUP(A1, D:E, 2, FALSE), "未找到")<br/>
                如果VLOOKUP返回错误，显示"未找到"
            </div>

            <h2>4.10 实践练习</h2>
            <p>让我们通过一个实际案例来练习公式和函数的使用：</p>

            <ol>
                <li>创建一个销售数据表，包含：产品名称、数量、单价、折扣、金额</li>
                <li>使用公式计算金额：金额 = 数量 * 单价 * (1-折扣)</li>
                <li>使用SUM函数计算总金额</li>
                <li>使用AVERAGE函数计算平均单价</li>
                <li>使用IF函数判断销售状态：数量>10为"畅销"，否则为"普通"</li>
                <li>使用COUNTIF统计畅销产品数量</li>
                <li>使用SUMIF计算畅销产品的总金额</li>
                <li>使用VLOOKUP查找特定产品的信息</li>
                <li>使用UNIQUE函数提取不重复的产品名称</li>
                <li>使用FILTER函数筛选出金额大于1000的记录</li>
            </ol>

            <h2>4.11 AI辅助公式功能</h2>
            <p>Excel的AI辅助功能让公式编写更加智能。</p>

            <h3>智能公式建议</h3>
            <p>当开始输入函数时，Excel会根据上下文推荐合适的函数。</p>

            <h3>自然语言公式</h3>
            <p>可以用自然语言描述想要的计算，Excel自动生成公式：</p>
            <ul>
                <li>输入："计算A列的平均值"</li>
                <li>Excel生成：=AVERAGE(A:A)</li>
            </ul>

            <h3>公式解释</h3>
            <p>Excel可以解释复杂公式的含义，帮助理解公式逻辑。</p>

            <h2>4.12 本章小结</h2>
            <p>本章介绍了Excel的公式和函数功能，你现在应该能够：</p>
            <ul>
                <li>创建和使用基本公式</li>
                <li>理解并正确使用不同类型的单元格引用</li>
                <li>熟练使用常用函数进行计算和数据分析</li>
                <li>使用逻辑函数进行条件判断</li>
                <li>运用动态数组函数进行高级数据处理</li>
                <li>处理和调试公式错误</li>
                <li>利用AI辅助功能提高公式编写效率</li>
            </ul>

            <p>在下一章中，我们将学习如何创建专业的图表，让数据可视化更加直观和吸引人。</p>
        </div>
    </main>

    <script src="../js/main.js"></script>
</body>
</html>